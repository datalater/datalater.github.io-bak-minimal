---
title: 회고 - 화폐 예제 실습으로 TDD의 리듬 느껴보기
date: 2022-02-11-15:00:00+09:00
categories: [Retrospective]
tags: [tdd, tdd-by-example] # TAG names should always be lowercase
image:
  src: https://noticon-static.tammolo.com/dgggcrkxq/image/upload/v1574740301/noticon/up950fjgyekwqizq6xa6.png
  width: 100 # in pixels
  height: 100 # in pixels
  alt: TDD
mermaid: true
published: true
excerpt_separator: <!--end-of-description-->
---

## 💁 설명

[화폐 예제 실습으로 TDD의 리듬 느껴보기](/tags/tdd-by-example/)를 하면서 느낀 점을 회고합니다.

<!--end-of-description-->

## 📝 회고

> 무엇을 했고 무엇을 느꼈는지 적고 배운 점을 액션 플랜으로 연결해봅니다.

### [1장 다중 통화를 지원하는 Money 객체]({% post_url 2022-02-11-tdd-currency-1 %})

**"TDD 리듬이 깨지지 않도록 할일 목록을 지속적으로 관리해보자"**

**what**: 다중 통화를 지원하는 Money 객체를 만들기 위해 할일 목록과 테스트 코드를 작성하면서 테스트 코드를 통과시키는 작업을 했다.

**before**: 이전에 TDD로 개발을 했을 때는 할일 목록은 처음에만 간단하게 주석으로 작성하고 주로 테스트 코드를 어떻게 작성해야 할지에 집중했다.

**after**: 그런데 책을 읽고 실습하면서 인상깊었던 점이 할일 목록을 한 곳에 두고 지속적으로 업데이트한다는 점이었다. 그리고 그렇게 할일 목록을 한 곳에 두고 관리하면 지금 하고 있는 일에서 벗어나지 않게 막아주고 이런 장치가 TDD 리듬이 깨지지 않도록 도와주는데 일조한다고 느꼈다.

과거에 테스트 코드를 빠르게 통과시키기 위해 작업을 하다 보면 지금 작성한 코드가 예기치 못한 사이드 이펙트를 커버하지 못하는 것을 깨닫고 코드를 수정하거나 추가하는 등 작업의 범위가 예상보다 커져버려서 TDD의 리듬이 깨지는 경우도 종종 있었다. 그런데 책에서 제안하는 해결책은 매우 간단했다. 문제점이 눈에 보이면 할일 목록에 적어두고 그냥 넘어가고, 기존에 하던 작업을 계속 진행한다.

이제부터는 TDD를 할 때 할일 목록을 `app.todo.md` 같은 이름의 파일로 분리해서 작업하는 동안 지속적으로 관리해봐야겠다. 그러면 기존에 TDD 리듬이 깨지던 문제를 해결할 수 있을 것 같다.

### [2장 타락한 객체]({% post_url 2022-02-12-tdd-currency-2 %})

**"완벽한 인터페이스가 떠오를 때까지 테스트 코드를 미루는 게 아니다"**

**"작동하는 깔끔한 코드를 얻어내는 방법 중 하나가 TDD 프로세스에 담겨 있다"**

**what**: 타락한 객체의 죄악을 수습하기 위해 부작용에 대한 혐오감을 테스트로 변환하는 작업을 했다.

**before**: 테스트 코드를 통과시키는 구현 코드를 작성하는 와중에 예상하지 못했던 이런 저런 부작용이 느껴질 때가 있다. '아, 테스트 코드를 잘못 짰구나'. 그러면 하던 걸 멈추고 테스트 코드를 수정하게 된다.

**after**: 그런데 (동작 자체가 잘못된 게 아니라면) 일단 동작하는 코드를 만들고 나서 부작용의 느낌을 테스트 코드로 변환하면 된다는 걸 배웠다. 그리고 그게 저자가 작동하는 깔끔한 코드(clean code that works)를 분할 정복(divide and conquer)으로 얻어내는 방법이었다. 테스트를 빠르게 통과(GREEN)시켜서 동작하는 코드부터 만들고, 죄악을 수습(REFACTOR)해서 깔끔하게 만드는 것.

TDD를 할 때 테스트 코드를 통과시키려고 구현 코드를 짜다가 부작용이 느껴졌는데 동작 자체가 잘못된 게 아니라면 테스트 코드를 바로 수정하는 게 아니라 일단 그린을 얻어내서 작동하는 코드를 만들고, 그 다음에 리팩터링으로 깔끔한 코드를 얻어내자.

### [3장 모두를 위한 평등]({% post_url 2022-04-05-tdd-currency-3 %})

**"디자인 패턴을 사용하면 또 다른 오퍼레이션을 구현해야 할 것이다"**

**"설계를 어떻게 해야 할지, 프로그램이 어떻게 변화할지 감이 잡히지 않을 때는 삼각측량을 사용하자"**

**what**: 값 객체 패턴을 사용했고, 값 동치성 오퍼레이션에 대한 테스트 코드를 추가하고 통과시켰다. 이때 삼각측량을 사용하여 테스트 코드를 통과시켰다.

**before**: 값 객체 패턴이 무엇인지 몰랐다.

**after**: 값 객체 패턴을 언제, 왜 사용하는 것인지 배웠다. 특정 도메인에서 값을 나타내려고 하는데 primitive type이 적절하지 않을 경우 값 객체 패턴을 사용하면 유용하다. 테스트 코드를 구현할 때 해답이 보이면 바로 그 방법대로 구현하면 된다. 하지만 만약 설계를 어떻게 해야 할지, 리팩토링을 어떻게 해야 할지 감이 안 잡힌다면 삼각측량을 사용하여 일반적인 해를 요구하는 테스트 케이스를 추가해보자.

## 📚 See also

- [화폐 예제 실습으로 TDD의 리듬 느껴보기 (feat. TypeScript)](/tags/tdd-by-example)
